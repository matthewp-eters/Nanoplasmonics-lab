#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed May  3 11:55:53 2023

@author: matthewpeters
"""

import os
from pathlib import Path
import numpy as np
import pandas as pd
import scipy
from nptdms import TdmsFile
from scipy.optimize import curve_fit
from tkinter import Tk, filedialog
import matplotlib.pyplot as plt
import seaborn as sns
from scipy.stats import norm
from scipy import stats
from scipy import signal
plt.rc('xtick', labelsize=16) 
plt.rc('ytick', labelsize=16) 
plt.rc('axes', labelsize=18) 
plt.rc('legend', fontsize = 18)
plt.rc('font', family='sans-serif')


def plot_file_data(plot=False):
    # Create file dialog window
    root = Tk()
    root.withdraw()

    # Prompt user to select files
    file_names = filedialog.askopenfilenames(filetypes=[('CSV files', '*.csv'),
                                                        ('Text files', '*.txt'),
                                                        ('TDMS files', '*.tdms')],
                                             title='Select files')

    # Check if any files were selected
    if not file_names:
        raise ValueError('No files selected')

    # Initialize file data array
    num_files = len(file_names)
    file_data = []

    # Loop through each file
    for i in range(num_files):
        file_path = str(file_names[i])

        # Determine file type based on file extension
        ext = os.path.splitext(file_path)[1].lower()
        if ext == '.csv':
            data = pd.read_csv(file_path, skiprows=7, header=None).values
            time = data[:,0]
            voltage = data[:,2]
        elif ext == '.txt':
            data = pd.read_csv(file_path, skiprows=16, header=None, delim_whitespace=True).values
            voltage = data[:,0]
            time_step = 0.00001
            time = np.arange(0, (len(voltage)-0.5)*time_step, time_step)
        elif ext == '.tdms':
            tdms_file = TdmsFile(file_path)
            properties = tdms_file['Analog'].properties
            scanrate=properties['ScanRate']
            reference = tdms_file['Analog']['AI1']
            voltage = tdms_file['Analog']['AI2']
            time_step = 0.00001
            time = np.arange(0, (len(voltage)-0.5)*time_step, time_step)
        else:
            raise ValueError('File type not supported')
            
        
        # Load your original time series data (replace this with your actual data loading code)
        # Assuming your original data is stored in the variable 'original_data'
        # original_data = ...
        
        # Define the original and target sampling frequencies
        original_sampling_freq = 100000  # 100 kHz
        target_sampling_freq = 30  # 30 samples/s
        
        # Calculate the resampling factor
        resampling_factor = original_sampling_freq // target_sampling_freq
        
        
        # # Use the resample function to downsample the data
        #voltage = signal.resample(voltage, len(voltage) // resampling_factor)
        #time = signal.resample(time, len(time) // resampling_factor)
        # Now 'downsampled_data' contains your downsampled time series data
        
        # Save or process the downsampled data as needed
        

        # Store file data in array
        file_data.append({'time': time, 'voltage': voltage, 'fs': 100000, 'name': file_names[i]})

        # Apply a 1Hz low-pass filter to the voltage data
        cutoff_frequency = 10  # 1 Hz
        nyquist_frequency = 0.5 * 100000  # Nyquist frequency for your sampling rate
        b, a = signal.butter(1, cutoff_frequency / nyquist_frequency, btype='low')
        filtered_voltage = signal.lfilter(b, a, voltage)

        # ... (rest of the existing code)

        # Plot the data
        if plot:
            
            #signal_data = [191.0, 191.0, 187.0, 187.0, 187.0, 187.0, 191.0, 186.0, 186.0, 187.0, 188.0, 188.0, 185.0, 185.0, 185.0, 186.0, 186.0, 187.0, 187.0, 187.0, 188.0, 187.0, 187.0, 186.0, 187.0, 188.0, 188.0, 189.0, 187.0, 187.0, 186.0, 186.0, 187.0, 187.0, 186.0, 186.0, 185.0, 185.0, 186.0, 182.0, 185.0, 185.0, 187.0, 186.0, 187.0, 187.0, 185.0, 185.0, 185.0, 187.0, 187.0, 186.0, 187.0, 186.0, 187.0, 187.0, 187.0, 188.0, 185.0, 185.0, 186.0, 188.0, 188.0, 188.0, 187.0, 187.0, 187.0, 188.0, 187.0, 186.0, 186.0, 187.0, 184.0, 184.0, 184.0, 181.0, 184.0, 184.0, 185.0, 185.0, 184.0, 184.0, 182.0, 186.0, 189.0, 191.0, 181.0, 184.0, 184.0, 185.0, 187.0, 180.0, 181.0, 185.0, 184.0, 182.0, 184.0, 187.0, 188.0, 191.0, 191.0, 185.0, 188.0, 188.0, 186.0, 180.0, 181.0, 181.0, 182.0, 187.0, 185.0, 185.0, 182.0, 184.0, 184.0, 185.0, 189.0, 184.0, 184.0, 184.0, 185.0, 182.0, 182.0, 184.0, 186.0, 186.0, 187.0, 185.0, 187.0, 187.0, 186.0, 187.0, 184.0, 184.0, 181.0, 191.0, 191.0, 189.0, 185.0, 185.0, 185.0, 179.0, 181.0, 185.0, 185.0, 182.0, 187.0, 187.0, 184.0, 186.0, 184.0, 184.0, 184.0, 185.0, 184.0, 184.0, 189.0, 185.0, 185.0, 185.0, 187.0, 181.0, 181.0, 187.0, 189.0, 191.0, 191.0, 185.0, 185.0, 185.0, 187.0, 186.0, 184.0, 185.0, 188.0, 189.0, 186.0, 186.0, 184.0, 186.0, 186.0, 181.0, 185.0, 184.0, 184.0, 185.0, 184.0, 186.0, 186.0, 185.0, 186.0, 184.0, 184.0, 186.0, 181.0, 181.0, 182.0, 185.0, 186.0, 186.0, 185.0, 185.0, 185.0, 185.0, 181.0, 188.0, 188.0, 188.0, 186.0, 186.0, 185.0, 185.0, 186.0, 185.0, 185.0, 185.0, 182.0, 182.0, 181.0, 186.0, 181.0, 181.0, 186.0, 181.0, 182.0, 182.0, 181.0, 182.0, 182.0, 189.0, 185.0, 187.0, 187.0, 181.0, 188.0, 187.0, 187.0, 191.0, 191.0, 191.0, 186.0, 187.0, 187.0, 187.0, 187.0, 185.0, 187.0, 187.0, 186.0, 182.0, 182.0, 187.0, 187.0, 187.0, 187.0, 187.0, 187.0, 185.0, 185.0, 189.0, 185.0, 184.0, 186.0, 185.0, 185.0, 185.0, 184.0, 184.0, 186.0, 186.0, 181.0, 185.0, 185.0, 187.0, 182.0, 183.0, 183.0, 184.0, 184.0, 184.0, 184.0, 184.0, 186.0, 188.0, 188.0, 189.0, 190.0, 190.0, 185.0, 186.0, 181.0, 181.0, 185.0, 186.0, 185.0, 185.0, 185.0, 188.0, 189.0, 187.0, 182.0, 184.0, 184.0, 188.0, 186.0, 187.0, 187.0, 186.0, 187.0, 187.0, 187.0, 189.0, 187.0, 187.0, 188.0, 185.0, 188.0, 188.0, 186.0, 190.0, 190.0, 186.0, 184.0, 187.0, 187.0, 184.0, 186.0, 185.0, 185.0, 184.0, 185.0, 184.0, 185.0, 191.0, 186.0, 186.0, 187.0, 189.0, 182.0, 182.0, 186.0, 184.0, 184.0, 186.0, 186.0, 185.0, 185.0, 185.0, 186.0, 182.0, 182.0, 182.0, 188.0, 188.0, 189.0, 188.0, 186.0, 186.0, 182.0, 184.0, 186.0, 186.0, 185.0, 187.0, 187.0, 187.0, 187.0, 186.0, 186.0, 185.0, 182.0, 187.0, 187.0, 186.0, 185.0, 187.0, 187.0, 184.0, 182.0, 182.0, 185.0, 186.0, 185.0, 185.0, 185.0, 185.0, 185.0, 186.0, 184.0, 189.0, 192.0, 185.0, 187.0, 185.0, 185.0, 182.0, 184.0, 182.0, 184.0, 185.0, 184.0, 184.0, 187.0, 187.0, 186.0, 186.0, 188.0, 184.0, 180.0, 179.0, 181.0, 186.0, 186.0, 180.0, 187.0, 187.0, 186.0, 186.0, 186.0, 182.0, 186.0, 185.0, 184.0, 184.0, 181.0, 182.0, 185.0, 185.0, 188.0, 184.0, 185.0, 185.0, 181.0, 186.0, 187.0, 188.0, 185.0, 186.0, 186.0, 185.0, 184.0, 187.0, 187.0, 186.0, 185.0, 185.0, 185.0, 182.0, 185.0, 186.0, 182.0, 186.0, 184.0, 184.0, 184.0, 186.0, 186.0, 184.0, 182.0, 184.0, 184.0, 186.0, 185.0, 186.0, 185.0, 186.0, 187.0, 188.0, 188.0, 186.0, 181.0, 181.0, 187.0, 185.0, 180.0, 180.0, 186.0, 184.0, 186.0, 187.0, 187.0, 187.0, 187.0, 187.0, 186.0, 189.0, 189.0, 184.0, 186.0, 189.0, 189.0, 186.0, 182.0, 182.0, 188.0, 184.0, 184.0, 184.0, 185.0, 182.0, 184.0, 184.0, 186.0, 185.0, 185.0, 186.0, 181.0, 184.0, 184.0, 182.0, 184.0, 186.0, 186.0, 185.0, 186.0, 186.0, 185.0, 187.0, 188.0, 188.0, 189.0, 185.0, 185.0, 185.0, 189.0, 186.0, 186.0, 186.0, 185.0, 185.0, 185.0, 184.0, 189.0, 191.0, 191.0, 188.0, 187.0, 187.0, 187.0, 186.0, 186.0, 186.0, 182.0, 184.0, 184.0, 184.0, 184.0, 184.0, 184.0, 186.0, 185.0, 187.0, 187.0, 186.0, 184.0, 181.0, 181.0, 182.0, 186.0, 185.0, 185.0, 184.0, 185.0, 185.0, 181.0, 189.0, 184.0, 184.0, 187.0, 185.0, 185.0, 185.0, 187.0, 186.0, 186.0, 185.0, 182.0, 182.0, 182.0, 182.0, 186.0, 180.0, 180.0, 182.0, 181.0, 181.0, 188.0, 181.0, 185.0, 185.0, 186.0, 187.0, 182.0, 182.0, 184.0, 182.0, 182.0, 180.0, 185.0, 185.0, 186.0, 182.0, 183.0, 188.0, 188.0, 185.0, 180.0, 180.0, 192.0, 185.0, 186.0, 186.0, 184.0, 188.0, 185.0, 185.0, 182.0, 182.0, 184.0, 182.0, 185.0, 186.0, 186.0, 185.0, 182.0, 185.0, 185.0, 187.0, 189.0, 189.0, 185.0, 187.0, 186.0, 186.0, 184.0, 184.0, 186.0, 186.0, 187.0, 187.0, 188.0, 186.0, 185.0, 187.0, 187.0, 188.0, 184.0, 186.0, 186.0, 185.0, 184.0, 186.0, 186.0, 186.0, 188.0, 188.0, 185.0, 185.0, 182.0, 182.0, 188.0, 186.0, 186.0, 186.0, 184.0, 186.0, 186.0, 182.0, 183.0, 184.0, 184.0, 185.0, 184.0, 182.0, 182.0, 185.0, 191.0, 191.0, 186.0, 186.0, 181.0, 180.0, 184.0, 186.0, 184.0, 184.0, 181.0, 185.0, 186.0, 188.0, 185.0, 185.0, 184.0, 186.0, 187.0, 184.0, 184.0, 184.0, 186.0, 186.0, 185.0, 186.0, 185.0, 185.0, 186.0, 180.0, 184.0, 184.0, 184.0, 182.0, 182.0, 187.0, 184.0, 185.0, 185.0, 185.0, 184.0, 186.0, 186.0, 186.0, 184.0, 184.0, 182.0, 185.0, 182.0, 180.0, 187.0, 184.0, 185.0, 185.0, 184.0, 185.0, 185.0, 186.0, 186.0, 188.0, 188.0, 182.0, 184.0, 180.0, 180.0, 179.0, 179.0, 180.0, 180.0, 185.0, 185.0, 185.0, 182.0, 187.0, 180.0, 180.0, 185.0, 184.0, 180.0, 179.0, 177.0, 187.0, 187.0, 185.0, 184.0, 186.0, 186.0, 187.0, 186.0, 184.0, 184.0, 186.0, 187.0, 187.0, 188.0, 186.0, 186.0, 186.0, 186.0, 182.0, 186.0, 186.0, 189.0, 184.0, 184.0, 184.0, 184.0, 184.0, 184.0, 186.0, 182.0, 181.0, 181.0, 184.0, 184.0, 184.0, 182.0, 183.0, 186.0, 186.0, 185.0, 186.0, 187.0, 187.0, 188.0, 188.0, 188.0, 186.0, 191.0, 186.0, 185.0, 180.0, 182.0, 182.0, 181.0, 182.0, 183.0, 183.0, 181.0, 183.0, 179.0, 178.0, 181.0, 177.0, 183.0, 183.0, 172.0, 184.0, 185.0, 179.0, 186.0, 187.0, 187.0, 188.0, 186.0, 184.0, 184.0, 181.0, 179.0, 178.0, 178.0, 178.0, 179.0, 179.0, 181.0, 181.0, 182.0, 182.0, 181.0, 179.0, 182.0, 182.0, 181.0, 182.0, 182.0, 185.0, 189.0, 189.0, 189.0, 198.0, 194.0, 193.0, 193.0, 195.0, 192.0, 192.0, 187.0, 191.0, 186.0, 186.0, 188.0, 189.0, 187.0, 187.0, 188.0, 195.0, 195.0, 192.0, 192.0, 187.0, 187.0, 181.0, 189.0, 189.0, 191.0, 189.0, 201.0, 201.0, 191.0, 188.0, 193.0, 193.0, 182.0, 184.0, 188.0, 188.0, 184.0, 184.0, 184.0, 189.0, 189.0, 191.0, 191.0, 191.0, 191.0, 195.0, 195.0, 200.0, 187.0, 184.0, 192.0, 187.0, 196.0, 196.0, 184.0, 184.0, 200.0, 200.0, 199.0, 202.0, 202.0, 186.0, 192.0, 195.0, 195.0, 187.0, 168.0, 166.0, 166.0, 162.0, 163.0, 161.0, 161.0, 157.0, 162.0, 162.0, 157.0, 157.0, 157.0, 157.0, 156.0, 158.0, 158.0, 158.0, 159.0, 164.0, 164.0, 161.0, 161.0, 160.0, 160.0, 165.0, 158.0, 170.0, 170.0, 163.0, 162.0, 162.0, 160.0, 166.0, 158.0, 158.0, 159.0, 159.0, 162.0, 162.0, 160.0, 158.0, 158.0, 157.0, 158.0, 159.0, 159.0, 160.0, 160.0, 160.0, 160.0, 158.0, 166.0, 166.0, 159.0, 162.0, 163.0, 163.0, 158.0, 158.0, 160.0, 160.0, 162.0, 158.0, 157.0, 159.0, 156.0, 157.0, 158.0, 162.0, 157.0, 158.0, 158.0, 157.0, 158.0, 158.0, 158.0, 158.0, 159.0, 159.0, 157.0, 163.0, 160.0, 159.0, 157.0, 159.0, 159.0, 158.0, 160.0, 158.0, 158.0, 158.0, 158.0, 157.0, 157.0, 160.0, 159.0, 159.0, 162.0, 158.0, 160.0, 159.0, 164.0, 162.0, 155.0, 155.0, 155.0, 159.0, 157.0, 157.0, 160.0, 159.0, 160.0, 156.0, 160.0, 158.0, 156.0, 158.0, 157.0, 158.0, 159.0, 152.0, 157.0, 157.0, 160.0, 157.0, 158.0, 158.0, 164.0, 157.0, 158.0, 158.0, 157.0, 160.0, 160.0, 162.0, 162.0, 161.0, 161.0, 159.0, 157.0, 160.0, 160.0, 159.0, 159.0, 158.0, 159.0, 162.0, 159.0, 159.0, 160.0, 163.0, 160.0, 160.0, 158.0, 159.0, 158.0, 159.0, 159.0, 162.0, 162.0, 160.0, 159.0, 160.0, 160.0, 162.0, 158.0, 158.0, 161.0, 156.0, 157.0, 158.0, 157.0, 156.0, 160.0, 160.0, 158.0, 160.0, 160.0, 159.0, 162.0, 156.0, 156.0, 153.0, 161.0, 157.0, 157.0, 156.0, 153.0, 159.0, 159.0, 157.0, 158.0, 157.0, 157.0, 158.0, 157.0, 157.0, 161.0, 160.0, 157.0, 156.0, 158.0, 154.0, 154.0, 155.0, 156.0, 159.0, 159.0, 159.0, 157.0, 161.0, 161.0, 153.0, 158.0, 158.0, 157.0, 159.0, 163.0, 163.0, 157.0, 155.0, 158.0, 158.0, 155.0, 156.0, 156.0, 157.0, 156.0, 157.0, 157.0, 156.0, 159.0, 156.0, 156.0, 158.0, 155.0, 155.0, 156.0, 162.0, 161.0, 161.0, 156.0, 157.0, 159.0, 158.0, 156.0, 160.0, 163.0, 160.0, 156.0, 159.0, 159.0, 163.0, 154.0, 157.0, 157.0, 158.0, 156.0, 156.0, 158.0, 158.0, 164.0, 165.0, 159.0, 164.0, 160.0, 160.0, 159.0, 162.0, 162.0, 159.0, 163.0, 157.0, 157.0, 162.0, 162.0, 157.0, 158.0, 159.0, 160.0, 158.0, 158.0, 160.0, 157.0, 157.0, 163.0, 158.0, 158.0, 158.0, 160.0, 159.0, 162.0, 162.0, 156.0, 157.0, 157.0, 160.0, 158.0, 153.0, 153.0, 160.0, 164.0, 158.0, 158.0, 161.0, 160.0, 160.0, 158.0, 159.0, 159.0, 160.0, 160.0, 156.0, 157.0, 157.0, 158.0, 157.0, 156.0, 160.0, 160.0, 159.0, 159.0, 160.0, 159.0, 159.0, 159.0, 159.0, 159.0, 159.0, 157.0, 160.0, 156.0, 156.0, 152.0, 158.0, 160.0, 160.0, 158.0, 160.0, 160.0, 156.0, 159.0, 157.0, 156.0, 162.0, 158.0, 163.0, 163.0, 159.0, 159.0, 159.0, 163.0, 159.0, 160.0, 160.0, 156.0, 160.0, 156.0, 155.0, 161.0, 155.0, 156.0, 156.0, 156.0, 152.0, 151.0, 158.0, 158.0, 160.0, 160.0, 158.0, 157.0, 161.0, 161.0, 157.0, 158.0, 159.0, 160.0, 157.0, 159.0, 159.0, 159.0, 158.0, 156.0, 156.0, 161.0, 154.0, 154.0, 157.0, 158.0, 165.0, 165.0, 162.0, 156.0, 156.0, 156.0, 158.0, 156.0, 156.0, 158.0, 160.0, 156.0, 155.0, 160.0, 154.0, 155.0, 155.0, 158.0, 155.0, 155.0, 160.0, 160.0, 159.0, 159.0, 156.0, 157.0, 156.0, 156.0, 152.0, 163.0, 163.0, 158.0, 159.0, 158.0, 158.0, 157.0, 157.0, 159.0, 159.0, 160.0, 158.0, 158.0, 159.0, 159.0, 158.0, 158.0, 158.0, 162.0, 163.0, 163.0, 156.0, 155.0, 155.0, 156.0, 152.0, 160.0, 160.0, 158.0, 157.0, 157.0, 157.0, 158.0, 159.0, 159.0, 159.0, 159.0, 160.0, 162.0, 157.0, 160.0, 164.0, 164.0, 158.0, 157.0, 154.0, 154.0, 158.0, 156.0, 156.0, 160.0, 159.0, 156.0, 157.0, 157.0, 157.0, 156.0, 156.0, 157.0, 159.0, 159.0, 160.0, 159.0, 161.0, 161.0, 161.0, 158.0, 159.0, 159.0, 151.0, 157.0, 157.0, 166.0, 159.0, 159.0, 159.0, 157.0, 157.0, 157.0, 157.0, 159.0, 159.0, 159.0, 157.0, 158.0, 163.0, 163.0, 158.0, 162.0, 159.0, 159.0, 156.0, 157.0, 157.0, 158.0, 159.0, 158.0, 159.0, 163.0, 157.0, 158.0, 158.0, 158.0, 156.0, 156.0, 158.0, 155.0, 155.0, 155.0, 160.0, 158.0, 160.0, 162.0, 156.0, 158.0, 158.0, 157.0, 160.0, 154.0, 154.0, 156.0, 157.0, 157.0, 157.0, 160.0, 158.0, 158.0, 158.0, 158.0, 158.0, 158.0, 153.0, 159.0, 157.0, 157.0, 157.0, 159.0, 159.0, 159.0, 163.0, 156.0, 156.0, 159.0, 156.0, 165.0, 165.0, 159.0, 159.0, 156.0, 156.0, 159.0, 162.0, 162.0, 157.0, 152.0, 155.0, 155.0, 158.0, 157.0, 158.0, 158.0, 159.0, 159.0, 160.0, 159.0, 157.0, 158.0, 158.0, 159.0, 162.0, 158.0, 158.0, 158.0, 151.0, 151.0, 160.0, 157.0, 159.0, 159.0, 158.0, 160.0, 158.0, 158.0, 158.0, 157.0, 157.0, 159.0, 160.0, 157.0, 157.0, 156.0, 159.0, 159.0, 160.0, 160.0, 159.0, 159.0, 162.0, 156.0, 158.0, 158.0, 157.0, 162.0, 155.0, 154.0, 152.0, 155.0, 155.0, 156.0, 156.0, 157.0, 157.0, 157.0, 156.0, 159.0, 159.0, 158.0, 157.0, 157.0, 157.0, 160.0, 159.0, 159.0, 160.0, 157.0, 156.0, 156.0, 159.0, 170.0, 161.0, 161.0, 157.0, 160.0, 160.0, 155.0, 156.0, 155.0, 155.0, 158.0, 157.0, 158.0, 158.0, 160.0, 157.0, 157.0, 156.0, 156.0, 158.0, 160.0, 158.0, 151.0, 152.0, 153.0, 159.0, 154.0, 154.0, 158.0, 157.0, 153.0, 153.0, 158.0, 156.0, 164.0, 164.0, 160.0, 158.0, 158.0, 162.0, 161.0, 153.0, 153.0, 156.0, 152.0, 157.0, 157.0, 159.0, 158.0, 158.0, 157.0, 160.0, 156.0, 157.0, 153.0, 159.0, 156.0, 156.0, 160.0, 158.0, 158.0, 158.0, 158.0, 158.0, 158.0, 156.0, 162.0, 159.0, 159.0, 159.0, 159.0, 159.0, 164.0, 157.0, 159.0, 159.0, 164.0, 156.0, 158.0, 158.0, 158.0, 157.0, 157.0, 156.0, 160.0, 157.0, 157.0, 160.0, 158.0, 162.0, 162.0, 157.0, 156.0, 160.0, 160.0, 156.0, 156.0, 156.0, 163.0, 156.0, 152.0, 152.0, 158.0, 160.0, 160.0, 160.0, 160.0, 157.0, 157.0, 156.0, 157.0, 163.0, 163.0, 162.0, 157.0, 163.0, 163.0, 158.0, 159.0, 159.0, 157.0, 157.0, 158.0, 158.0, 158.0, 155.0, 156.0, 156.0, 160.0, 159.0, 159.0, 160.0, 160.0, 156.0, 156.0, 153.0, 163.0, 153.0, 155.0, 158.0, 158.0, 157.0, 157.0, 159.0, 159.0, 159.0, 160.0, 157.0, 160.0, 161.0, 162.0, 158.0, 159.0, 160.0, 157.0, 153.0, 153.0, 159.0, 159.0, 160.0, 160.0, 160.0, 158.0, 158.0, 160.0, 159.0, 157.0, 157.0, 157.0, 156.0, 158.0, 158.0, 156.0, 158.0, 158.0, 158.0, 158.0, 156.0, 156.0, 156.0, 158.0, 158.0, 158.0, 155.0, 156.0, 155.0, 156.0, 159.0, 159.0, 159.0, 158.0, 157.0, 159.0, 160.0, 161.0, 158.0, 160.0, 159.0, 157.0, 156.0, 157.0, 156.0, 155.0, 156.0, 156.0, 159.0, 158.0, 163.0, 163.0, 159.0, 157.0, 157.0, 154.0, 160.0, 153.0, 153.0, 160.0, 160.0, 159.0, 159.0, 161.0, 162.0, 162.0, 157.0, 153.0, 155.0, 155.0, 156.0, 153.0, 157.0, 157.0, 158.0, 158.0, 158.0, 158.0, 158.0, 163.0, 163.0, 160.0, 160.0, 153.0, 153.0, 158.0, 158.0, 158.0, 158.0, 158.0, 164.0, 165.0, 162.0, 158.0, 156.0, 156.0, 158.0, 160.0, 160.0, 164.0, 157.0, 157.0, 157.0, 152.0, 158.0, 153.0, 153.0, 158.0, 160.0, 161.0, 157.0, 163.0, 160.0, 159.0, 157.0, 158.0, 157.0, 157.0, 156.0, 156.0, 157.0, 157.0, 156.0, 157.0, 157.0, 154.0, 153.0, 160.0, 160.0, 158.0, 156.0, 151.0, 151.0, 150.0, 150.0, 150.0, 159.0, 158.0, 157.0, 157.0, 158.0, 154.0, 153.0, 153.0, 155.0, 155.0, 156.0, 152.0, 159.0, 162.0, 160.0, 158.0, 158.0, 148.0, 148.0, 151.0, 156.0, 156.0, 155.0, 154.0, 156.0, 155.0, 158.0, 164.0, 163.0, 164.0, 159.0, 158.0, 158.0, 158.0, 162.0, 157.0, 157.0, 163.0, 159.0, 158.0, 158.0, 162.0, 156.0, 156.0, 153.0, 153.0, 160.0, 160.0, 157.0, 159.0, 157.0, 156.0, 157.0, 164.0, 164.0, 159.0, 165.0, 157.0, 157.0, 157.0, 156.0, 159.0, 159.0, 156.0, 159.0, 159.0, 159.0, 157.0, 159.0, 159.0, 160.0, 158.0, 159.0, 159.0, 164.0, 159.0, 156.0, 155.0, 157.0, 157.0, 157.0, 159.0, 159.0, 159.0, 159.0, 155.0, 160.0, 159.0, 159.0, 159.0, 160.0, 160.0, 159.0, 153.0, 159.0, 159.0, 158.0, 159.0, 157.0, 158.0, 158.0, 157.0, 157.0, 159.0, 165.0, 157.0, 157.0, 159.0, 162.0, 162.0, 162.0, 159.0, 159.0, 159.0, 157.0, 155.0, 155.0, 156.0, 158.0, 156.0, 159.0, 159.0, 157.0, 158.0, 158.0, 162.0, 159.0, 161.0, 161.0, 159.0, 164.0, 163.0, 163.0, 160.0, 159.0, 159.0, 163.0, 159.0, 158.0, 158.0, 156.0, 158.0, 160.0, 160.0, 160.0, 162.0, 162.0, 153.0, 164.0, 163.0, 163.0, 159.0, 158.0, 165.0, 164.0, 157.0, 156.0, 156.0, 157.0, 159.0, 160.0, 160.0, 157.0, 155.0, 156.0, 155.0, 158.0, 158.0, 155.0, 155.0, 160.0, 160.0, 160.0, 158.0, 159.0, 153.0, 153.0, 158.0, 159.0, 156.0, 156.0, 158.0, 156.0, 156.0, 155.0, 162.0, 158.0, 158.0, 160.0, 157.0, 157.0, 155.0, 158.0, 156.0, 155.0, 157.0, 164.0, 155.0, 155.0, 156.0, 158.0, 159.0, 159.0, 159.0, 157.0, 158.0, 157.0, 156.0, 155.0, 155.0, 157.0, 159.0, 160.0, 160.0, 160.0, 160.0, 160.0, 158.0, 155.0, 159.0, 159.0, 159.0, 158.0, 158.0, 158.0, 160.0, 162.0, 162.0, 157.0, 159.0, 160.0, 160.0, 158.0, 158.0, 158.0, 158.0, 157.0, 151.0, 150.0, 159.0, 155.0, 158.0, 158.0, 160.0, 167.0, 159.0, 158.0, 158.0, 156.0, 157.0, 156.0, 163.0, 152.0, 152.0, 157.0, 158.0, 159.0, 159.0, 159.0, 157.0, 156.0, 156.0, 156.0, 154.0, 153.0, 159.0, 157.0, 160.0, 158.0, 155.0, 149.0, 156.0, 156.0, 156.0, 156.0, 156.0, 152.0, 153.0, 154.0, 154.0, 157.0, 158.0, 157.0, 157.0, 160.0, 156.0, 156.0, 158.0, 156.0, 163.0, 163.0, 155.0, 159.0, 159.0, 159.0, 158.0, 157.0, 158.0, 160.0, 156.0, 160.0, 160.0, 162.0, 158.0, 158.0, 158.0, 159.0, 159.0, 159.0, 156.0, 157.0, 150.0, 153.0, 155.0, 163.0, 149.0, 150.0, 155.0, 159.0, 160.0, 158.0, 158.0, 157.0, 157.0, 157.0, 153.0, 150.0, 152.0, 155.0, 155.0, 156.0, 153.0, 158.0, 158.0, 158.0, 160.0, 164.0, 165.0, 165.0, 162.0, 156.0, 156.0, 159.0, 157.0, 157.0, 157.0, 156.0, 156.0, 156.0, 155.0, 157.0, 157.0, 156.0, 156.0, 158.0, 158.0, 158.0, 160.0, 158.0, 156.0, 156.0, 160.0, 155.0, 156.0, 155.0, 155.0, 156.0, 156.0, 157.0, 158.0, 153.0, 153.0, 155.0, 156.0, 155.0, 155.0, 159.0, 158.0, 158.0, 162.0, 164.0, 160.0, 160.0, 163.0, 156.0, 158.0, 158.0, 152.0, 157.0, 157.0, 158.0, 158.0, 159.0, 159.0, 157.0, 157.0, 159.0, 159.0, 161.0, 159.0, 159.0, 157.0, 153.0, 156.0, 157.0, 158.0, 158.0, 158.0, 158.0, 159.0, 159.0, 159.0, 157.0, 157.0, 160.0, 162.0, 163.0, 157.0, 158.0, 158.0, 155.0, 163.0, 163.0, 161.0, 157.0, 158.0, 158.0, 160.0, 156.0, 159.0, 159.0, 156.0, 155.0, 155.0, 158.0, 156.0, 158.0, 158.0, 151.0, 158.0, 155.0, 155.0, 156.0, 158.0, 157.0, 157.0, 160.0, 163.0, 162.0, 159.0, 156.0, 158.0, 158.0, 159.0, 163.0, 157.0, 157.0, 158.0, 153.0, 153.0, 153.0, 159.0, 156.0, 156.0, 156.0, 162.0, 162.0, 162.0, 160.0, 158.0, 159.0, 156.0, 158.0, 158.0, 157.0, 159.0, 158.0, 156.0, 156.0, 159.0, 163.0, 163.0, 156.0, 160.0, 153.0, 153.0, 159.0, 156.0, 155.0, 155.0, 158.0, 157.0, 157.0, 155.0, 153.0, 157.0, 157.0, 159.0, 160.0, 158.0, 158.0, 158.0, 159.0, 160.0, 153.0, 155.0, 159.0, 160.0, 152.0, 158.0, 161.0, 161.0, 158.0, 157.0, 157.0, 156.0, 157.0, 157.0, 157.0, 159.0, 158.0, 158.0, 159.0, 157.0, 160.0, 161.0, 158.0, 157.0, 153.0, 153.0, 157.0, 156.0, 158.0, 159.0, 160.0, 158.0, 156.0, 157.0, 158.0, 156.0, 156.0, 156.0, 159.0, 157.0, 157.0, 153.0, 155.0, 156.0, 157.0, 158.0, 158.0, 157.0, 160.0, 158.0, 153.0, 153.0, 160.0, 155.0, 155.0, 155.0, 158.0, 156.0, 153.0, 155.0, 155.0, 155.0, 155.0, 158.0, 155.0, 157.0, 157.0, 158.0, 158.0, 159.0, 158.0, 157.0, 156.0, 156.0, 153.0, 156.0, 153.0, 152.0, 152.0, 158.0, 158.0, 158.0, 154.0, 156.0, 156.0, 156.0, 155.0, 158.0, 158.0, 156.0, 158.0, 158.0, 157.0, 157.0, 157.0, 158.0, 159.0, 159.0, 158.0, 158.0, 157.0, 162.0, 162.0, 159.0, 157.0, 169.0, 169.0, 170.0, 164.0, 154.0, 154.0, 158.0, 159.0, 159.0, 163.0, 159.0, 153.0, 153.0, 156.0, 155.0, 159.0, 159.0, 169.0, 163.0, 166.0, 166.0, 153.0, 155.0, 156.0, 163.0, 155.0, 156.0, 156.0, 155.0, 155.0, 157.0, 157.0, 159.0, 160.0, 158.0, 158.0, 153.0, 159.0, 159.0, 156.0, 159.0, 158.0, 158.0, 158.0, 156.0, 156.0, 160.0, 158.0, 159.0, 160.0, 156.0, 164.0, 162.0, 162.0, 160.0, 160.0, 159.0, 159.0, 151.0, 155.0, 155.0, 162.0, 158.0, 160.0, 160.0, 157.0, 155.0, 156.0, 155.0, 157.0, 157.0, 157.0, 158.0, 163.0, 160.0, 162.0, 159.0, 152.0, 153.0, 157.0, 157.0, 157.0, 157.0, 157.0, 158.0, 155.0, 155.0, 160.0, 162.0, 160.0, 161.0, 162.0, 164.0, 164.0, 168.0, 170.0, 164.0, 164.0, 165.0, 165.0, 165.0, 165.0, 166.0, 167.0, 167.0, 160.0, 165.0, 164.0, 165.0, 166.0, 167.0, 171.0, 171.0, 165.0, 165.0, 165.0, 163.0, 170.0, 165.0, 165.0, 170.0, 170.0, 169.0, 169.0, 157.0, 164.0, 164.0, 158.0, 161.0, 159.0, 159.0, 172.0, 171.0, 170.0, 170.0, 166.0, 165.0, 165.0, 163.0, 164.0, 165.0, 165.0, 164.0, 162.0, 171.0, 172.0, 169.0, 166.0, 167.0, 173.0, 169.0, 166.0, 166.0, 170.0, 163.0, 162.0, 162.0, 158.0, 156.0, 156.0, 163.0, 158.0, 156.0, 156.0, 160.0, 163.0, 159.0, 158.0, 164.0, 159.0, 159.0, 166.0, 160.0, 159.0, 159.0, 160.0, 162.0, 153.0, 153.0, 157.0, 163.0, 163.0, 158.0, 159.0, 164.0, 163.0, 158.0, 162.0, 160.0, 159.0, 159.0, 158.0]
            
            # signal_data = [0.0, 0.0, 170.0, 170.0, 170.0, 170.0, 175.0, 175.0, 175.0, 173.0, 173.0, 170.0, 170.0, 173.0, 173.0, 173.0, 172.0, 172.0, 169.0, 167.0, 169.0, 169.0, 169.0, 169.0, 169.0, 171.0, 171.0, 167.0, 167.0, 169.0, 167.0, 167.0, 171.0, 171.0, 174.0, 174.0, 171.0, 171.0, 171.0, 173.0, 173.0, 170.0, 170.0, 174.0, 174.0, 174.0, 172.0, 172.0, 173.0, 173.0, 174.0, 174.0, 178.0, 178.0, 178.0, 178.0, 178.0, 173.0, 173.0, 177.0, 177.0, 177.0, 175.0, 175.0, 163.0, 163.0, 146.0, 146.0, 146.0, 164.0, 164.0, 145.0, 145.0, 155.0, 155.0, 155.0, 163.0, 163.0, 157.0, 157.0, 162.0, 162.0, 163.0, 163.0, 163.0, 150.0, 150.0, 156.0, 156.0, 148.0, 148.0, 148.0, 162.0, 162.0, 157.0, 157.0, 150.0, 150.0, 150.0, 153.0, 153.0, 164.0, 164.0, 158.0, 158.0, 170.0, 170.0, 170.0, 165.0, 165.0, 158.0, 159.0, 149.0, 149.0, 149.0, 167.0, 167.0, 159.0, 159.0, 160.0, 159.0, 159.0, 159.0, 159.0, 178.0, 178.0, 157.0, 157.0, 157.0, 152.0, 151.0, 166.0, 166.0, 146.0, 146.0, 162.0, 162.0, 162.0, 169.0, 169.0, 155.0, 156.0, 152.0, 152.0, 152.0, 153.0, 153.0, 146.0, 146.0, 150.0, 150.0, 150.0, 147.0, 147.0, 163.0, 163.0, 163.0, 163.0, 162.0, 162.0, 162.0, 151.0, 152.0, 147.0, 147.0, 158.0, 158.0, 158.0, 159.0, 159.0, 165.0, 165.0, 156.0, 156.0, 156.0, 144.0, 144.0, 159.0, 159.0, 170.0, 170.0, 158.0, 158.0, 158.0, 149.0, 149.0, 166.0, 166.0, 163.0, 163.0, 163.0, 167.0, 167.0, 171.0, 171.0, 156.0, 156.0, 156.0, 157.0, 157.0, 172.0, 172.0, 149.0, 149.0, 149.0, 158.0, 159.0, 148.0, 146.0, 157.0, 156.0, 163.0, 162.0, 162.0, 158.0, 158.0, 160.0, 160.0, 162.0, 162.0, 162.0, 149.0, 149.0, 156.0, 156.0, 159.0, 159.0, 159.0, 164.0, 164.0, 149.0, 149.0, 151.0, 151.0, 152.0, 152.0, 152.0, 151.0, 151.0, 159.0, 160.0, 159.0, 159.0, 159.0, 151.0, 151.0, 146.0, 146.0, 151.0, 151.0, 151.0, 157.0, 157.0, 143.0, 144.0, 171.0, 171.0, 171.0, 149.0, 149.0, 136.0, 136.0, 143.0, 143.0, 137.0, 137.0, 137.0, 138.0, 137.0, 143.0, 142.0, 139.0, 139.0, 139.0, 136.0, 136.0, 136.0, 136.0, 137.0, 137.0, 137.0, 135.0, 135.0, 148.0, 148.0, 136.0, 136.0, 152.0, 152.0, 152.0, 131.0, 131.0, 127.0, 127.0, 138.0, 138.0, 138.0, 142.0, 142.0, 136.0, 136.0, 144.0, 144.0, 144.0, 146.0, 148.0, 131.0, 131.0, 152.0, 152.0, 152.0, 129.0, 129.0, 128.0, 128.0, 137.0, 137.0, 144.0, 144.0, 144.0, 139.0, 139.0, 137.0, 136.0, 129.0, 129.0, 129.0, 129.0, 129.0, 134.0, 132.0, 132.0, 132.0, 132.0, 131.0, 131.0, 139.0, 139.0, 136.0, 136.0, 131.0, 131.0, 131.0, 127.0, 128.0, 134.0, 134.0, 141.0, 141.0, 141.0, 129.0, 129.0, 134.0, 134.0, 139.0, 139.0, 139.0, 132.0, 132.0, 130.0, 130.0, 134.0, 132.0, 135.0, 135.0, 135.0, 137.0, 137.0, 127.0, 125.0, 131.0, 131.0, 131.0, 134.0, 134.0, 144.0, 144.0, 132.0, 132.0, 132.0, 129.0, 129.0, 131.0, 131.0, 131.0, 132.0, 131.0, 125.0, 125.0, 130.0, 131.0, 127.0, 127.0, 128.0, 128.0, 128.0, 146.0, 146.0, 130.0, 130.0, 130.0, 130.0, 130.0, 134.0, 134.0, 128.0, 128.0, 136.0, 136.0, 136.0, 138.0, 138.0, 123.0, 123.0, 138.0, 138.0, 129.0, 129.0, 129.0, 128.0, 128.0, 138.0, 138.0, 128.0, 128.0, 128.0, 137.0, 137.0, 131.0, 131.0, 123.0, 123.0, 123.0, 135.0, 136.0, 127.0, 127.0, 135.0, 135.0, 135.0, 125.0, 125.0, 123.0, 123.0, 135.0, 135.0, 127.0, 127.0, 127.0, 130.0, 131.0, 122.0, 122.0, 122.0, 122.0, 122.0, 124.0, 124.0, 127.0, 127.0, 130.0, 130.0, 130.0, 122.0, 122.0, 132.0, 132.0, 137.0, 137.0, 119.0, 118.0, 118.0, 123.0, 123.0, 120.0, 120.0, 111.0, 111.0, 111.0, 115.0]
            signal_data = [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 54.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 2.0, 2.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0, 8.0, 8.0, 10.0, 12.0, 9.0, 9.0, 8.0, 9.0, 8.0, 8.0, 10.0, 8.0, 10.0, 10.0, 9.0, 10.0, 8.0, 8.0, 6.0, 9.0, 9.0, 4.0, 4.0, 7.0, 9.0, 4.0, 4.0, 7.0, 9.0, 10.0, 10.0, 8.0, 7.0, 8.0, 8.0, 10.0, 13.0, 9.0, 9.0, 14.0, 11.0, 14.0, 14.0, 9.0, 8.0, 13.0, 13.0, 12.0, 9.0, 11.0, 10.0, 10.0, 10.0, 15.0, 9.0, 9.0, 12.0, 8.0, 13.0, 13.0, 13.0, 11.0, 13.0, 13.0, 12.0, 12.0, 12.0, 12.0, 10.0, 11.0, 8.0, 9.0, 11.0, 10.0, 10.0, 10.0, 11.0, 12.0, 11.0, 11.0, 12.0, 10.0, 9.0, 10.0, 10.0, 10.0, 11.0, 10.0, 10.0, 11.0, 14.0, 12.0, 14.0, 11.0, 10.0, 8.0, 8.0, 7.0, 11.0, 10.0, 10.0, 9.0, 5.0, 9.0, 9.0, 8.0, 13.0, 8.0, 8.0, 10.0, 8.0, 11.0, 10.0, 10.0, 7.0, 14.0, 7.0, 7.0, 12.0, 8.0, 8.0, 8.0, 9.0, 8.0, 9.0, 9.0, 11.0, 7.0, 10.0, 10.0, 7.0, 8.0, 9.0, 9.0, 7.0, 8.0, 11.0, 11.0, 8.0, 11.0, 15.0, 14.0, 14.0, 7.0, 9.0, 12.0, 12.0, 8.0, 10.0, 9.0, 9.0, 9.0, 11.0, 11.0, 10.0, 9.0, 10.0, 8.0, 8.0, 10.0, 11.0, 12.0, 12.0, 10.0, 9.0, 8.0, 9.0, 11.0, 11.0, 11.0, 11.0, 10.0, 7.0, 13.0, 10.0, 10.0, 12.0, 10.0, 11.0, 11.0, 9.0, 9.0, 8.0, 8.0, 11.0, 10.0, 10.0, 10.0, 9.0, 12.0, 9.0, 9.0, 11.0, 12.0, 11.0, 11.0, 12.0, 10.0, 11.0, 11.0, 8.0, 8.0, 11.0, 8.0, 8.0, 9.0, 8.0, 10.0, 10.0, 8.0, 7.0, 8.0, 9.0, 7.0, 8.0, 10.0, 10.0, 9.0, 9.0, 12.0, 12.0, 10.0, 5.0, 11.0, 11.0, 13.0, 10.0, 9.0, 9.0, 12.0, 11.0, 12.0, 12.0, 10.0, 10.0, 10.0, 9.0, 9.0, 9.0, 9.0, 10.0, 10.0, 11.0, 8.0, 6.0, 6.0, 9.0, 8.0, 10.0, 10.0, 11.0, 9.0, 10.0, 10.0, 9.0, 11.0, 11.0, 11.0, 8.0, 10.0, 12.0, 12.0, 11.0, 12.0, 11.0, 7.0, 7.0, 11.0, 9.0, 13.0, 13.0, 11.0, 12.0, 10.0, 10.0, 15.0, 13.0, 12.0, 12.0, 11.0, 10.0, 10.0, 10.0, 8.0, 9.0, 10.0, 10.0, 9.0, 12.0, 12.0, 12.0, 12.0, 12.0, 13.0, 13.0, 13.0, 12.0, 11.0, 11.0, 11.0, 11.0, 11.0, 10.0, 10.0, 11.0, 10.0, 8.0, 8.0, 9.0, 11.0, 8.0, 8.0, 9.0, 11.0, 11.0, 11.0, 9.0, 11.0, 12.0, 12.0, 9.0, 11.0, 10.0, 10.0, 12.0, 11.0, 9.0, 12.0, 14.0, 10.0, 10.0, 12.0, 12.0, 10.0, 11.0, 9.0, 9.0, 9.0, 12.0, 13.0, 13.0, 10.0, 12.0, 7.0, 7.0, 12.0, 14.0, 10.0, 10.0, 15.0, 8.0, 7.0, 7.0, 13.0, 8.0, 11.0, 11.0, 11.0, 9.0, 9.0, 10.0, 10.0, 10.0, 10.0, 10.0, 11.0, 10.0, 8.0, 12.0, 12.0, 9.0, 10.0, 10.0, 10.0, 9.0, 11.0, 12.0, 12.0, 10.0, 12.0, 10.0, 10.0, 14.0, 12.0, 11.0, 11.0, 11.0, 12.0, 11.0, 13.0, 12.0, 9.0, 12.0, 11.0, 12.0, 8.0, 11.0, 10.0, 10.0, 12.0, 14.0, 9.0, 9.0, 10.0, 8.0, 15.0, 15.0, 9.0, 7.0, 11.0, 11.0, 11.0, 14.0, 8.0, 8.0, 12.0, 8.0, 11.0, 12.0, 12.0, 11.0, 8.0, 5.0, 5.0, 11.0, 9.0, 12.0, 12.0, 7.0, 10.0, 9.0, 9.0, 4.0, 7.0, 10.0, 10.0, 8.0, 14.0, 10.0, 9.0, 12.0, 7.0, 9.0, 9.0, 11.0, 9.0, 10.0, 10.0, 8.0, 7.0, 9.0, 9.0, 9.0, 10.0, 10.0, 12.0, 12.0, 10.0, 8.0, 6.0, 6.0, 10.0, 10.0, 8.0, 7.0, 8.0, 8.0, 7.0, 8.0, 9.0, 10.0, 6.0, 6.0, 8.0, 7.0, 5.0, 5.0, 9.0, 11.0, 3.0, 6.0, 6.0, 9.0, 10.0, 10.0, 10.0, 13.0, 11.0, 9.0, 9.0, 9.0, 9.0, 11.0, 11.0, 12.0, 7.0, 10.0, 10.0, 12.0, 12.0, 11.0, 11.0, 10.0, 10.0, 12.0, 11.0, 9.0, 11.0, 14.0, 9.0, 10.0, 7.0, 7.0, 8.0, 8.0, 10.0, 8.0, 11.0, 12.0, 5.0, 10.0, 9.0, 9.0, 9.0, 10.0, 11.0, 11.0, 5.0, 9.0, 11.0, 11.0, 9.0, 8.0, 9.0, 9.0, 8.0, 9.0, 7.0, 7.0, 10.0, 8.0, 10.0, 7.0, 7.0, 10.0, 10.0, 10.0, 10.0, 7.0, 9.0, 9.0, 9.0, 9.0, 5.0, 8.0, 8.0, 11.0, 9.0, 4.0, 4.0, 7.0, 8.0, 9.0, 9.0, 9.0, 11.0, 5.0, 5.0, 10.0, 3.0, 9.0, 7.0, 7.0, 8.0, 7.0, 9.0, 9.0, 11.0, 9.0, 12.0, 12.0, 9.0, 10.0, 10.0, 10.0, 11.0, 7.0, 7.0, 7.0, 8.0, 8.0, 10.0, 10.0, 10.0, 6.0, 8.0, 8.0, 10.0, 9.0, 11.0, 11.0, 12.0, 8.0, 10.0, 10.0, 10.0, 9.0, 11.0, 12.0, 12.0, 10.0, 9.0, 12.0, 12.0, 11.0, 10.0, 5.0, 5.0, 9.0, 11.0, 6.0, 6.0, 10.0, 7.0, 11.0, 11.0, 11.0, 9.0, 9.0, 9.0, 12.0, 9.0, 10.0, 10.0, 10.0, 10.0, 9.0, 12.0, 12.0, 9.0, 12.0, 10.0, 10.0, 9.0, 9.0, 8.0, 8.0, 11.0, 9.0, 9.0, 9.0, 10.0, 10.0, 10.0, 10.0, 8.0, 7.0, 11.0, 12.0, 7.0, 10.0, 8.0, 8.0, 12.0, 10.0, 12.0, 10.0, 10.0, 11.0, 10.0, 9.0, 9.0, 9.0, 8.0, 9.0, 9.0, 10.0, 10.0, 9.0, 9.0, 8.0, 10.0, 6.0, 6.0, 8.0, 11.0, 8.0, 8.0, 9.0, 10.0, 9.0, 9.0, 7.0, 11.0, 5.0, 8.0, 8.0, 9.0, 10.0, 11.0, 11.0, 9.0, 9.0, 10.0, 11.0, 12.0, 7.0, 12.0, 12.0, 12.0, 10.0, 8.0, 8.0, 7.0, 9.0, 10.0, 10.0, 7.0, 10.0, 7.0, 7.0, 12.0, 10.0, 10.0, 10.0, 10.0, 10.0, 11.0, 9.0, 9.0, 5.0, 9.0, 10.0, 10.0, 8.0, 12.0, 5.0, 5.0, 10.0, 12.0, 9.0, 9.0, 12.0, 11.0, 12.0, 12.0, 11.0, 10.0, 9.0, 9.0, 9.0, 6.0, 9.0, 11.0, 12.0, 7.0, 8.0, 10.0, 10.0, 5.0, 9.0, 9.0, 9.0, 10.0, 9.0, 7.0, 7.0, 8.0, 8.0, 11.0, 11.0, 12.0, 7.0, 8.0, 8.0, 10.0, 4.0, 9.0, 9.0, 5.0, 11.0, 8.0, 8.0, 9.0, 9.0, 9.0, 9.0, 9.0, 11.0, 7.0, 8.0, 8.0, 5.0, 10.0, 8.0, 8.0, 7.0, 7.0, 8.0, 8.0, 8.0, 8.0, 10.0, 10.0, 11.0, 12.0, 10.0, 10.0, 10.0, 10.0, 7.0, 7.0, 7.0, 5.0, 6.0, 6.0, 7.0, 6.0, 9.0, 8.0, 8.0, 12.0, 6.0, 11.0, 11.0, 9.0, 9.0, 8.0, 8.0, 8.0, 7.0, 8.0, 8.0, 9.0, 7.0, 7.0, 7.0, 7.0, 9.0, 11.0, 11.0, 9.0, 10.0, 9.0, 9.0, 8.0, 11.0, 9.0, 9.0, 9.0, 10.0, 11.0, 8.0, 8.0, 11.0, 7.0, 13.0, 13.0, 10.0, 10.0, 8.0, 9.0, 11.0, 7.0, 11.0, 11.0, 10.0, 14.0, 9.0, 9.0, 8.0, 11.0, 9.0, 9.0, 9.0, 7.0, 8.0, 8.0, 10.0, 12.0, 10.0, 10.0, 10.0, 12.0, 9.0, 14.0, 14.0, 10.0, 12.0, 12.0, 12.0, 8.0, 15.0, 9.0, 10.0, 9.0, 10.0, 8.0, 8.0, 9.0, 8.0, 5.0, 5.0, 7.0, 10.0, 9.0, 9.0, 9.0, 10.0, 8.0, 12.0, 12.0, 11.0, 10.0, 8.0, 8.0, 7.0, 12.0, 9.0, 9.0, 12.0, 12.0, 16.0, 16.0, 10.0, 10.0, 9.0, 9.0, 11.0, 11.0, 11.0, 11.0, 9.0, 11.0, 14.0, 14.0, 12.0, 11.0, 9.0, 14.0, 14.0, 12.0, 11.0, 11.0, 10.0, 9.0, 12.0, 12.0, 12.0, 6.0, 9.0, 9.0, 9.0, 10.0, 7.0, 7.0, 7.0, 11.0, 10.0, 11.0, 11.0, 10.0, 8.0, 10.0, 10.0, 10.0, 9.0, 11.0, 11.0, 9.0, 8.0, 8.0, 9.0, 9.0, 10.0, 14.0, 12.0, 12.0, 11.0, 10.0, 10.0, 10.0, 10.0, 10.0, 11.0, 11.0, 6.0, 13.0, 8.0, 8.0, 10.0, 11.0, 8.0, 7.0, 8.0, 11.0, 13.0, 13.0, 10.0, 10.0, 12.0, 12.0, 12.0, 11.0, 8.0, 11.0, 11.0, 9.0, 12.0, 9.0, 9.0, 15.0, 13.0, 14.0, 14.0, 11.0, 11.0, 8.0, 8.0, 10.0, 9.0, 9.0, 9.0, 10.0, 10.0, 10.0, 10.0, 11.0, 9.0, 12.0, 12.0, 12.0, 10.0, 9.0, 11.0, 10.0, 11.0, 10.0, 12.0, 12.0, 8.0, 7.0, 9.0, 9.0, 10.0, 9.0, 10.0, 10.0, 12.0, 11.0, 11.0, 12.0, 8.0, 9.0, 9.0, 9.0, 10.0, 12.0, 9.0, 9.0, 8.0, 8.0, 4.0, 12.0, 12.0, 10.0, 11.0, 7.0, 7.0, 10.0, 8.0, 8.0, 8.0, 9.0, 11.0, 10.0, 10.0, 8.0, 10.0, 8.0, 8.0, 7.0, 8.0, 4.0, 4.0, 7.0, 8.0, 7.0, 7.0, 7.0, 6.0, 8.0, 8.0, 9.0, 8.0, 13.0, 9.0, 9.0, 9.0, 9.0, 10.0, 10.0, 9.0, 8.0, 16.0, 16.0, 11.0, 14.0, 11.0, 10.0, 11.0, 14.0, 8.0, 8.0, 10.0, 11.0, 10.0, 10.0, 10.0, 10.0, 11.0, 11.0, 11.0, 11.0, 8.0, 9.0, 9.0, 11.0, 9.0, 8.0, 8.0, 9.0, 11.0, 11.0, 11.0, 15.0, 12.0, 11.0, 11.0, 11.0, 11.0, 10.0, 10.0, 10.0, 12.0, 9.0, 9.0, 10.0, 10.0, 11.0, 10.0, 11.0, 8.0, 12.0, 11.0, 11.0, 9.0, 10.0, 14.0, 14.0, 14.0, 11.0, 14.0, 14.0, 14.0, 8.0, 9.0, 9.0, 11.0, 12.0, 8.0, 8.0, 11.0, 8.0, 10.0, 10.0, 10.0, 10.0, 9.0, 9.0, 10.0, 9.0, 10.0, 10.0, 12.0, 14.0, 12.0, 7.0, 7.0, 9.0, 10.0, 11.0, 12.0, 9.0, 10.0, 12.0, 12.0, 8.0, 7.0, 11.0, 11.0, 10.0, 10.0, 9.0, 9.0, 8.0, 8.0, 9.0, 9.0, 9.0, 9.0, 12.0, 12.0, 10.0, 11.0, 9.0, 12.0, 12.0, 9.0, 12.0, 8.0, 8.0, 9.0, 10.0, 12.0, 12.0]
            signal_data = np.array(signal_data)
            signal_data = ((signal_data / np.max(signal_data)) * 0.65) + 0.8-0.0319
    
            time_step_2 = 1/29.7
            time_2 = np.arange(0, (len(signal_data)-0.5)*time_step_2, time_step_2)
            
            idx = find_nearest_idx(time_2, 46.3)
            
            signal_data = signal_data[idx:-1]
            time_2 = time_2[idx:-1]
            time_2 = time_2 - time_2[0]  # Shift time array to start at 0
                        

            plt.figure()

            plt.plot(time, voltage, linewidth=1, color='k', alpha = 0.5, label='APD')
            plt.plot(time, filtered_voltage, linewidth=2, color = 'orange', label='APD (1Hz LPF)')
            plt.plot(time_2, signal_data, linewidth = 2, color = 'm', label = '1D Video Intensity')

            plt.xticks(np.arange(0, max(time), step=1))
            plt.xlabel('Time (s)')
            plt.ylabel('Voltage (V)')
            plt.legend()  # Add legend to differentiate original and filtered data
            plt.savefig(file_names[i] + 'trapped.png')
        else:
            pass

        

    return file_data


def Lorentzian(f, A, fc):
    return A / (f**2 + fc**2)


def compute_PSD(voltage, fs, start, ending, name, run=False):
    if run:
     
        if not isinstance(voltage, np.ndarray):
            voltage_array=np.array(voltage[0])
        else:
            voltage_array = voltage
        
        notch_freq = 56
        q = 10
        b_notch, a_notch = signal.iirnotch(notch_freq, q, fs)
        voltage_array = signal.filtfilt(b_notch, a_notch, voltage_array)
        
        notch_freq = 29
        q = 10
        b_notch, a_notch = signal.iirnotch(notch_freq, q, fs)
        voltage_array = signal.filtfilt(b_notch, a_notch, voltage_array)

        
        voltage_fft = scipy.fftpack.fft(voltage_array)
        voltage_PSD = np.abs(voltage_fft)**2 / (len(voltage_array)/fs)
        

        
        fftfreq = scipy.fftpack.fftfreq(len(voltage_PSD), d=1/fs)
        

        
        i = fftfreq > 0
  
        return fftfreq[i], voltage_PSD[i], name
    else:
        pass


def find_nearest_idx(array, value):
    """
    Returns the index of the nearest value in an array to a given value.
    """
    return np.argmin(np.abs(array - value))


def psd_fitter(psd, minFreq, maxFreq, filename, plot = False, run=False):
    if run:
        
        freqs = psd[0]
        psd_data = psd[1]
        file_name = psd[2]
        
        min_freq_idx = find_nearest_idx(freqs, minFreq)
        max_freq_idx = find_nearest_idx(freqs, maxFreq)
        
        fs = freqs[min_freq_idx:max_freq_idx] #freqs for fitting x axis
        ys = psd_data[min_freq_idx:max_freq_idx] #data for fitting y axis
        
        p0 = (ys[0], 100) #A, fc
        params, cv = scipy.optimize.curve_fit(Lorentzian, fs, ys, p0, sigma = None, absolute_sigma = True )
        A, fc = params
        squaredDiffs = np.square(ys - Lorentzian(fs, A, fc))
        squaredDiffsFromMean = np.square(ys-np.mean(ys))
        rSquared = 1- np.sum(squaredDiffs) / np.sum(squaredDiffsFromMean)
        
        if plot:
            plt.figure()
            plt.plot(fs, ys, '.', label = "data")
            plt.plot(fs, Lorentzian(fs, A, fc),'--', label="fitted")
            plt.title(f"Corner freq = {-fc} Hz")
            #plt.text(.01, .01, file_name, ha='left', va='bottom')
            plt.xlabel('Frequency (Hz)')
            plt.ylabel('P (V$^2$/Hz')
            plt.xscale('Log')
            plt.yscale('Log')
            plt.savefig(filename + 'PSD.png')  
            #plt.close()
        else:
            pass
        return fc
    else:
        pass 
    

def histogram(trapped, bins='auto', density=True, plot=True, run=False):

    if run:
        
        if plot:
            """
            Calculate and plot the histogram of a signal along with a probability density function (PDF).
        
            Args:
                signal (array-like): Input signal.
                bins (int or array-like, optional): Number of bins or bin edges for the histogram. Defaults to 'auto'.
                density (bool, optional): If True, normalize the histogram to form a probability density function (PDF).
                                          Defaults to True.
                plot_pdf (bool, optional): If True, plot the PDF on the same graph. Defaults to True.
            """
            # Calculate the histogram
            hist, bin_edges = np.histogram(trapped, bins=bins, density=density)
        
            # Calculate the bin centers
            bin_centers = (bin_edges[:1] + bin_edges[-1:]) / 2
        
            # Plot the histogram
        
                # Calculate the PDF
            pdf = stats.norm.pdf(bin_centers)
        
                # Plot the PDF
            plt.figure()
            plt.plot(bin_centers, hist, label="Histogram of samples")
            plt.plot(bin_centers, pdf, 'r-', label='PDF')
        
            plt.xlabel('Value')
            plt.ylabel('Frequency' if not density else 'Probability Density')
            plt.legend()
            plt.show()
        else:
            pass
    
        #print("File Name:", file_name)
        #print("FWHM:", fwhm)
    
        return #fwhm
    else:
        return
 

def plot_on_top(files, plot = False):
   if plot:
        plt.figure()
    
        for data in files:
            time = data['time']
            voltage = data['voltage']
            name = data['name']
            plt.plot(time, voltage, linewidth=1)
            
        plt.xticks(np.arange(0, max(time), step=100))
        plt.xlabel('Time (s)', fontsize=20, fontweight='bold')
        plt.ylabel('Voltage (V)', fontsize=20, fontweight='bold')
        plt.xticks(fontsize=16)
        plt.show()
        
def calculate_rmsd(signal, window_length, file_name, run=False):
    """
    Calculate the RMSD for sections of the input signal based on a single window length
    and print the file name and average RMSD value.

    Args:
        signal (array-like): Input signal.
        window_length (int): Length of the window for splitting the data.
        file_name (str): Name of the file.

    Returns:
        float: Average RMSD value.
    """
    if run:
    
         num_sections = len(signal) // window_length
         rmsd_values = []
         mean_signal = np.mean(signal)
         
         for i in range(num_sections):
             section = signal[i * window_length : (i + 1) * window_length]
             squared_diff = np.square(section - np.mean(section))
             mean_squared_diff = np.mean(squared_diff)            
             rmsd = np.sqrt(mean_squared_diff)
             rmsd_values.append(rmsd)
             
         average_rmsd = np.mean(rmsd_values)/mean_signal
             
             # print("File Name:", file_name)
             # print("Average RMSD:", average_rmsd)
         
         return average_rmsd
    else:
         pass



        
def newFile(trapped, write=False):
    
    if write:
        # reshape data to a single column
        trapped = trapped.reshape(-1, 1)
            
        # save data to text file
        np.savetxt('CA011_LASER_NOISE', trapped, fmt='%.8f', delimiter='\n')
    else:
           pass 


file_data = plot_file_data(plot=True)
PSD_data = []
files = []
cornerFreq = []
if file_data:
    print("Files selected successfully!")
    
    plot_on_top(file_data, plot = False)
    
    average_rmsd_list = []
    for data in file_data:
        time = data['time']
        start = 0.7
        ending = 1.5
        voltage = data['voltage']
        #voltage2=data['voltage2']
        minTrappedTime = find_nearest_idx(time, start)
        maxTrappedTime = find_nearest_idx(time, ending)
        trapped = voltage[minTrappedTime:maxTrappedTime]
        fs = data['fs']
        name = data['name']
        
        # Call compute_PSD function to compute PSD
        psd = compute_PSD(trapped, fs, start, ending, name, run=False)
        PSD_data.append(psd)
        files.append(name)
        
        average_rmsd = calculate_rmsd(trapped, 100000, name, run=False)
        average_rmsd_list.append(average_rmsd)
        
        histogram(trapped, plot=False, run=False)
    newFile(trapped, write=False)

    for array, file_name in zip(PSD_data, files):
        fc = psd_fitter(array, 8.5, 1000, file_name, plot=False, run=False)
        cornerFreq.append(fc)
        
    print(average_rmsd_list)
    print(cornerFreq)
    

        
else:
    print("No files selected.")
